<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Source code</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Source code</h1><br/><p></p><p></p><p># Source code ::::::::::::::::::</p><p></p><p>#DataFlair Python Image Stegangraphy project</p><p>from tkinter import *</p><p>import tkinter.filedialog</p><p>from tkinter import messagebox</p><p>from PIL import ImageTk</p><p>from PIL import Image</p><p>from io import BytesIO</p><p>import os</p><p></p><p></p><p>#main source code </p><p>    def main(self, root):</p><p>        root.title(&#39;ImageSteganography by DataFlair&#39;)</p><p>        root.geometry(&#39;500x600&#39;)</p><p>        root.resizable(width =False, height=False)</p><p>        root.config(bg = &#39;#e3f4f1&#39;)</p><p>        frame = Frame(root)</p><p>        frame.grid()</p><p>       </p><p>        title = Label(frame,text=&#39;DataFlair Image Steganography&#39;)</p><p>        title.config(font=(&#39;Times new roman&#39;,25, &#39;bold&#39;),bg = &#39;#e3f4f1&#39;)</p><p>        title.grid(pady=10)</p><p>        title.grid(row=1)</p><p> </p><p>        encode = Button(frame,text=&quot;Encode&quot;,command= lambda :self.encode_frame1(frame), padx=14,bg = &#39;#e3f4f1&#39; )</p><p>        encode.config(font=(&#39;Helvetica&#39;,14), bg=&#39;#e8c1c7&#39;)</p><p>        encode.grid(row=2)</p><p>        decode = Button(frame, text=&quot;Decode&quot;,command=lambda :self.decode_frame1(frame), padx=14,bg = &#39;#e3f4f1&#39;)</p><p>        decode.config(font=(&#39;Helvetica&#39;,14), bg=&#39;#e8c1c7&#39;)</p><p>        decode.grid(pady = 12)</p><p>        decode.grid(row=3)</p><p> </p><p>        root.grid_rowconfigure(1, weight=1)</p><p>        root.grid_columnconfigure(0, weight=1)</p><p>        </p><p>        #frame for encode page</p><p>    def encode_frame1(self,F):</p><p>        F.destroy()</p><p>        F2 = Frame(root)</p><p>        label1= Label(F2,text=&#39;Select the Image in which \n you want to hide text :&#39;)</p><p>        label1.config(font=(&#39;Times new roman&#39;,25, &#39;bold&#39;),bg = &#39;#e3f4f1&#39;)</p><p>        label1.grid()</p><p> </p><p>        button_bws = Button(F2,text=&#39;Select&#39;,command=lambda : self.encode_frame2(F2))</p><p>        button_bws.config(font=(&#39;Helvetica&#39;,18), bg=&#39;#e8c1c7&#39;)</p><p>        button_bws.grid()</p><p>        button_back = Button(F2, text=&#39;Cancel&#39;, command=lambda : IMG_Stegno.back(self,F2))</p><p>        button_back.config(font=(&#39;Helvetica&#39;,18),bg=&#39;#e8c1c7&#39;)</p><p>        button_back.grid(pady=15)</p><p>        button_back.grid()</p><p>        F2.grid()</p><p> </p><p>#decode source code</p><p></p><p>    def decode_frame1(self,F):</p><p>        F.destroy()</p><p>        d_f2 = Frame(root)</p><p>        lablel1 = Label(d_f2, text=&#39;Select Image with Hidden text:&#39;)</p><p>        label1.config(font=(&#39;Times new roman&#39;,25,&#39;bold&#39;),bg = &#39;#e3f4f1&#39;)</p><p>        label1.grid()</p><p>        label1.config(bg = &#39;#e3f4f1&#39;)</p><p>        button_bws = Button(d_f2, text=&#39;Select&#39;, command=lambda :self.decode_frame2(d_f2))</p><p>        button_bws.config(font=(&#39;Helvetica&#39;,18), bg=&#39;#e8c1c7&#39;)</p><p>        button_bws.grid()</p><p>        button_back = Button(d_f2, text=&#39;Cancel&#39;, command=lambda : IMG_Stegno.back(self,d_f2))</p><p>        button_back.config(font=(&#39;Helvetica&#39;,18), bg=&#39;#e8c1c7&#39;)</p><p>        button_back.grid(pady=15)</p><p>        button_back.grid()</p><p>        d_f2.grid()</p><p>        </p><p>        #  encode source code </p><p>        </p><p>    def encode_frame2(self,e_F2):</p><p>        e_pg= Frame(root)</p><p>        myfile = tkinter.filedialog.askopenfilename(filetypes = ([(&#39;png&#39;, &#39;*.png&#39;),(&#39;jpeg&#39;, &#39;*.jpeg&#39;),(&#39;jpg&#39;, &#39;*.jpg&#39;),(&#39;All Files&#39;, &#39;*.*&#39;)]))</p><p>        if not myfile:</p><p>            messagebox.showerror(&quot;Error&quot;,&quot;You have selected nothing !&quot;)</p><p>        else:</p><p>            my_img = Image.open(myfile)</p><p>            new_image = my_img.resize((300,200))</p><p>            img = ImageTk.PhotoImage(new_image)</p><p>            label3= Label(e_pg,text=&#39;Selected Image&#39;)</p><p>            label3.config(font=(&#39;Helvetica&#39;,14,&#39;bold&#39;))</p><p>            label3.grid() </p><p>            board = Label(e_pg, image=img)</p><p>            board.image = img</p><p>            self.output_image_size = os.stat(myfile)</p><p>            self.o_image_w, self.o_image_h = my_img.size</p><p>            board.grid()</p><p>            label2 = Label(e_pg, text=&#39;Enter the message&#39;)</p><p>            label2.config(font=(&#39;Helvetica&#39;,14,&#39;bold&#39;))</p><p>            label2.grid(pady=15)</p><p>            text_a = Text(e_pg, width=50, height=10)</p><p>            text_a.grid()</p><p>            encode_button = Button(e_pg, text=&#39;Cancel&#39;, command=lambda : IMG_Stegno.back(self,e_pg))</p><p>            encode_button.config(font=(&#39;Helvetica&#39;,14), bg=&#39;#e8c1c7&#39;)</p><p>            data = text_a.get(&quot;1.0&quot;, &quot;end-1c&quot;)</p><p>            button_back = Button(e_pg, text=&#39;Encode&#39;, command=lambda : [self.enc_fun(text_a,my_img),IMG_Stegno.back(self,e_pg)])</p><p>            button_back.config(font=(&#39;Helvetica&#39;,14), bg=&#39;#e8c1c7&#39;)</p><p>            button_back.grid(pady=15)</p><p>            encode_button.grid()</p><p>            e_pg.grid(row=1)</p><p>            e_F2.destroy()</p><p>            </p><p>            # decode source code </p><p>    def decode_frame2(self,d_F2):</p><p>        d_F3 = Frame(root)</p><p>        myfiles = tkinter.filedialog.askopenfilename(filetypes = ([(&#39;png&#39;, &#39;*.png&#39;),(&#39;jpeg&#39;, &#39;*.jpeg&#39;),(&#39;jpg&#39;, &#39;*.jpg&#39;),(&#39;All Files&#39;, &#39;*.*&#39;)]))</p><p>        if not myfiles:</p><p>            messagebox.showerror(&quot;Error&quot;,&quot;You have selected nothing !&quot;)</p><p>        else:</p><p>            my_img = Image.open(myfiles, &#39;r&#39;)</p><p>            my_image = my_img.resize((300, 200))</p><p>            img = ImageTk.PhotoImage(my_image)</p><p>            label4= Label(d_F3,text=&#39;Selected Image :&#39;)</p><p>            label4.config(font=(&#39;Helvetica&#39;,14,&#39;bold&#39;))</p><p>            label4.grid()</p><p>            board = Label(d_F3, image=img)</p><p>            board.image = img</p><p>            board.grid()</p><p>            hidden_data = self.decode(my_img)</p><p>            label2 = Label(d_F3, text=&#39;Hidden data is :&#39;)</p><p>            label2.config(font=(&#39;Helvetica&#39;,14,&#39;bold&#39;))</p><p>            label2.grid(pady=10)</p><p>            text_a = Text(d_F3, width=50, height=10)</p><p>            text_a.insert(INSERT, hidden_data)</p><p>            text_a.configure(state=&#39;disabled&#39;)</p><p>            text_a.grid()</p><p>            button_back = Button(d_F3, text=&#39;Cancel&#39;, command= lambda :self.Page_3(d_F3))</p><p>            button_back.config(font=(&#39;Helvetica&#39;,14),bg=&#39;#e8c1c7&#39;)</p><p>            button_back.grid(pady=15)</p><p>            button_back.grid()</p><p>            d_F3.grid(row=1)</p><p>            d_F2.destroy()</p><p>            </p><p>            #decode data source code </p><p>    def decode(self, image):</p><p>        image_data = iter(image.getdata())</p><p>        data = &#39;&#39;</p><p> </p><p>        while (True):</p><p>            pixels = [value for value in image_data.__next__()[:3] +</p><p>                      image_data.__next__()[:3] +</p><p>                      image_data.__next__()[:3]]</p><p>            # string of binary data</p><p>            binary_str = &#39;&#39;</p><p>            for i in pixels[:8]:</p><p>                if i % 2 == 0:</p><p>                    binary_str += &#39;0&#39;</p><p>                else:</p><p>                    binary_str += &#39;1&#39;</p><p> </p><p>            data += chr(int(binary_str, 2))</p><p>            if pixels[-1] % 2 != 0:</p><p>                return data</p><p> </p><p>#function to generate data source code </p><p>    def generate_Data(self,data):</p><p>        # list of binary codes of given data</p><p>        new_data = []</p><p> </p><p>        for i in data:</p><p>            new_data.append(format(ord(i), &#39;08b&#39;))</p><p>        return new_data</p><p>        </p><p>        #function to modify the pixels of image source code </p><p>    def modify_Pix(self,pix, data):</p><p>        dataList = self.generate_Data(data)</p><p>        dataLen = len(dataList)</p><p>        imgData = iter(pix)</p><p>        for i in range(dataLen):</p><p>            </p><p>            pix = [value for value in imgData.__next__()[:3] +</p><p>                   imgData.__next__()[:3] +</p><p>                   imgData.__next__()[:3]]</p><p>                        for j in range(0, 8):</p><p>                if (dataList[i][j] == &#39;0&#39;) and (pix[j] % 2 != 0):</p><p> </p><p>                    if (pix[j] % 2 != 0):</p><p>                        pix[j] -= 1</p><p> </p><p>                elif (dataList[i][j] == &#39;1&#39;) and (pix[j] % 2 == 0):</p><p>                    pix[j] -= 1</p><p>                       if (i == dataLen - 1):</p><p>                if (pix[-1] % 2 == 0):</p><p>                    pix[-1] -= 1</p><p>            else:</p><p>                if (pix[-1] % 2 != 0):</p><p>                    pix[-1] -= 1</p><p> </p><p>            pix = tuple(pix)</p><p>            yield pix[0:3]</p><p>            yield pix[3:6]</p><p>            yield pix[6:9]</p><p>            </p><p>            #function to modify the pixels of image source code </p><p>    def modify_Pix(self,pix, data):</p><p>        dataList = self.generate_Data(data)</p><p>        dataLen = len(dataList)</p><p>        imgData = iter(pix)</p><p>        for i in range(dataLen):</p><p>            </p><p>            pix = [value for value in imgData.__next__()[:3] +</p><p>                   imgData.__next__()[:3] +</p><p>                   imgData.__next__()[:3]]</p><p>                        for j in range(0, 8):</p><p>                if (dataList[i][j] == &#39;0&#39;) and (pix[j] % 2 != 0):</p><p> </p><p>                    if (pix[j] % 2 != 0):</p><p>                        pix[j] -= 1</p><p> </p><p>                elif (dataList[i][j] == &#39;1&#39;) and (pix[j] % 2 == 0):</p><p>                    pix[j] -= 1</p><p>                       if (i == dataLen - 1):</p><p>                if (pix[-1] % 2 == 0):</p><p>                    pix[-1] -= 1</p><p>            else:</p><p>                if (pix[-1] % 2 != 0):</p><p>                    pix[-1] -= 1</p><p> </p><p>            pix = tuple(pix)</p><p>            yield pix[0:3]</p><p>            yield pix[3:6]</p><p>            yield pix[6:9]</p><p>            </p><p>           # function to enter hidden text source code </p><p>    def enc_fun(self,text_a,myImg):</p><p>        data = text_a.get(&quot;1.0&quot;, &quot;end-1c&quot;)</p><p>        if (len(data) == 0):</p><p>            messagebox.showinfo(&quot;Alert&quot;,&quot;Kindly enter text in TextBox&quot;)</p><p>        else:</p><p>            newImg = myImg.copy()</p><p>            self.encode_enc(newImg, data)</p><p>            my_file = BytesIO()</p><p>            temp=os.path.splitext(os.path.basename(myImg.filename))[0]</p><p>            newImg.save(tkinter.filedialog.asksaveasfilename (initialfile=temp, filetypes = ([(&#39;png&#39;, &#39;*.png&#39;)]), defaultextension=&quot;.png&quot;))</p><p>            self.d_image_size = my_file.tell()</p><p>            self.d_image_w,self.d_image_h = newImg.size</p><p>            messagebox.showinfo(&quot;Success&quot;,&quot;Encoding Successful\nFile is saved as Image_with_hiddentext.png in the same directory&quot;)</p><p> </p><p>    def frame_3(self,frame):</p><p>        frame.destroy()</p><p>        self.main(root)</p><p>        </p><p>        #GUI loop function source code</p><p>root = Tk()</p><p>o = IMG_Stegno()</p><p>o.main(root)</p><p>root.mainloop()</p></div>
</body>
</html>
